(function(){var e,q,k=function(c,a){return function(){return c.apply(a,arguments)}};angular.module("akop",["akop-multi-select","akop-keymap","akop-query-filter"]);angular.module("akop-keymap",[]).config(["$provide",function(c){return c.constant("KEYCODES",{backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause_break:19,caps:20,esc:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,
d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,left_window:91,right_window:92,select_key:93,numpad_0:96,numpad_1:97,numpad_2:98,numpad_3:99,numpad_4:100,numpad_5:101,numpad_6:102,numpad_7:103,numpad_8:104,numpad_9:105,"*":106,"+":107,minus:109,decimal_point:110,"%":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,num_lock:144,scroll_lock:145,";":186,"=":187,"":188,"-":189,".":190,"/":191,
grave_accent:192,"{":219,"\\":220,"}":221,"'":222})}]);e=function(c){var a,b,d,m;d=function(a,b,d){null==d&&(d=!0);d||a.sort()&&b.sort();return a.length===b.length&&a.every(function(a,d){return a===b[d]})};m=function(d){var b;b=[];d.altKey&&b.push(a("alt"));d.ctrlKey&&b.push(a("ctrl"));d.shiftKey&&b.push(a("shift"));b.push(parseInt(d.keyCode));return b};a=function(a){return c[a]};b=function(b){return _.map(b.split("-"),function(b){return a(b)})};return{codeFor:a,parseCombo:b,comboEventMatch:function(a,
c){return d(m(c),b(a),!1)}}};e.$inject=["KEYCODES"];angular.module("akop-keymap").service("KeymapUtils",e);angular.module("akop-multi-select",[]);q=function(){function c(a,b){this.list=a;this.root=b;this.moveToNext=k(this.moveToNext,this);this.moveToPrev=k(this.moveToPrev,this);this.selectFirst=k(this.selectFirst,this);this.selectLast=k(this.selectLast,this);this.selectNext=k(this.selectNext,this);this.selectPrev=k(this.selectPrev,this);this.root&&this.reset(this.root)}c.prototype.reset=function(a){this.root=
null!=a?a:null;_.each(this.list,function(a){a.selected=!1});this.selected=[];this.root&&this.include(this.root,!1);return this.selected};c.prototype.include=function(a,b){var d;null==b&&(b=!0);d=this._pos(a);if(0>d)throw Error("MultiSelect: Element must be a member of list.");if(b&&!this._isAdjacent(d))return!1;a.selected=!0;this.selected[d]=a;this.cursor=d;return this.selected};c.prototype.includeUntil=function(a){var b,d,c;if(this.selected.length)for(d=this._pos(a),a=this.cursor,b=c=d;d<=a?c<=a:
c>=a;b=d<=a?++c:--c)this.include(this.list[b],!1);else this.reset(a);return this.selected};c.prototype.exclude=function(a,b){var d,c;null==b&&(b=!0);d=this._pos(a);if(b){c=this._is_upper(d);d=this._is_lower(d);if(!c&&!d)return!1;c?(this.selected.pop(),this.cursor=this._upper_index()):(this.selected.splice(this._lower_index(),1,void 0),this.cursor=this._lower_index())}else this.selected.splice(d,1,void 0),this.cursor=this._closest_selected_index(d);a.selected=!1;return this.selected};c.prototype.moveCursorTo=
function(a){var b;if(0>a||a>this.list.length-1)return this.selected;b=this.list[a];return b.selected?(b=this._is_desc(a,this.cursor)?1:-1,this.exclude(this.list[a+b])):this.include(b)};c.prototype.selectPrev=function(){return null!=this.cursor===!1||0===this.cursor?this.reset(_.last(this.list)):this.reset(this.list[this.cursor-1])};c.prototype.selectNext=function(){return null!=this.cursor===!1||this.cursor===this.list.length-1?this.reset(this.list[0]):this.reset(this.list[this.cursor+1])};c.prototype.selectLast=
function(){return this.reset(_.last(this.list))};c.prototype.selectFirst=function(){return this.reset(_.first(this.list))};c.prototype.moveToPrev=function(){return this.moveCursorTo(this.cursor-1)};c.prototype.moveToNext=function(){return this.moveCursorTo(this.cursor+1)};c.prototype._closest_selected_index=function(a,b){var d,c,f;null==b&&(b=1);d=a+b;c=a-b;return 0>c&&d>this.list.length-1?!1:d<=this.list.length-1&&(f=this.list[d],f.selected)?d:0<=c&&(d=this.list[c],d.selected)?c:this._closest_selected_index(a,
b+1)};c.prototype._is_asc=function(a,b){return 1===a-b};c.prototype._is_desc=function(a,b){return-1===a-b};c.prototype._pos=function(a){return this.list.indexOf(a)};c.prototype._isAdjacent=function(a){return a-1===this._upper_index()||a+1===this._lower_index()};c.prototype._upper_index=function(){return this.selected.length-1};c.prototype._lower_index=function(){var a;a=_.filter(this.selected,function(a){return a});return this.selected.indexOf(_.first(a))};c.prototype._is_upper=function(a){return this._upper_index()===
a};c.prototype._is_lower=function(a){return this._lower_index()===a};return c}();angular.module("akop-multi-select").factory("MultiSelect",function(){return q});e=function(c,a,b){return{restrict:"A",link:function(b,m,f){b.$watch(f.akopMultiSelect,function(c){return b.multiSelect=new a(c||[])});b.keymap={up:function(){return b.multiSelect.selectPrev()},down:function(){return b.multiSelect.selectNext()},"shift-up":function(){return b.multiSelect.moveToPrev()},"shift-down":function(){return b.multiSelect.moveToNext()},
"alt-down":function(){return b.multiSelect.selectLast()},"alt-up":function(){return b.multiSelect.selectFirst()}};return m.bind("keydown",function(a){var m,f,e,n;e=b.keymap;n=[];for(m in e)f=e[m],n.push(b.$apply(function(){if(c.comboEventMatch(m,a))return f.call()}));return n})}}};e.$inject=["KeymapUtils","MultiSelect","$parse"];angular.module("akop-multi-select").directive("akopMultiSelect",e);angular.module("akop-query-filter",[]);e=function(c,a,b){var d;d=function(a,b,h){var e,g;for(null==h&&(h=
[]);a.length;)e=c("filter")(b,a.pop(),!0),h.push(e),d(a,(g=_(b)).without.apply(g,e),h);return _(h).flatten()};return function(c,f){var e,l,g;f=a(f);g=f.group_by;delete f.group_by;e=b.getArrayArguments(f);l=d(b.arrayArgsToExpressions(f),c);e=0<e.length?d([f],l):d([f],c);if(!g)return e;if(_.any(c,function(a){return void 0===a[g]}))throw Error('serviceQueryFilter: Missing group_by property "'+g+'" for some or all elements in list.');return _.groupBy(e,g)}};e.$inject=["$filter","akopParser","expressionUtils"];
angular.module("akop-query-filter").filter("akopQuery",e);angular.module("akop-query-filter").factory("akopParser",function(){return function(c){var a,b,d,e,f,h,l,g,k;if(c===Object(c)||!(1<c.split(":").length))return c;a=/(\w+):((\w+)|(\[.*\])|"(.*)")/g;for(d=[];b=a.exec(c);)d.push(b);e=function(a){return String(a).replace(/^[\s\"]+|[\s\"]+$/g,"")};c={};g=0;for(k=d.length;g<k;g++)b=d[g],a=b[1],b=b[5]||b[2],(h=b.match(/\[(.*)\]/))?(l=h[1].split(","),c[a]=function(){var a,b,c;c=[];a=0;for(b=l.length;a<
b;a++)f=l[a],c.push(""+e(f));return c}()):c[a]=""+b;return c}});e=function(){function c(){}c.prototype.getArrayArguments=function(a){var b,c;return _.compact(function(){var e;e=[];for(c in a)b=a[c],e.push(_.isArray(b)?{attr:c,arg:b}:void 0);return e}())};c.prototype.arrayArgsToExpressions=function(a){var b,c,e,f,h,l,g,k,n,p;e=[];n=this.getArrayArguments(a);h=0;for(g=n.length;h<g;h++)for(b=n[h],p=b.arg,l=0,k=p.length;l<k;l++)f=p[l],c={},c[b.attr]=f,delete a[b.attr],e.push(c);return e};return c}();
angular.module("akop-query-filter").service("expressionUtils",e)}).call(this);
